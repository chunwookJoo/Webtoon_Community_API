import{r as s,_ as ae,o as ne,q as ie,t as se,v as oe,w as le,x as B,d as ce,y as de,e as ue,z as he,f as pe,B as me,a as y,M as fe,j as n,C as ge,F,E as V,l as L,D as ve,G as be,H as Se,J as $,K as ye,k as U,N as Y,I as K,h as xe,u as Ne,O as Ce,P as Re,i as _e}from"./index-4c6f47ce.js";import{p as we,g as ze}from"./board-784e201d.js";import{I as w}from"./Input-ed245c9f.js";import"./Input.styles-9a7fdf8e.js";var Ee=s.useLayoutEffect,Pe=function(t){var e=s.useRef(t);return Ee(function(){e.current=t}),e},A=function(t,e){if(typeof t=="function"){t(e);return}t.current=e},Oe=function(t,e){var r=s.useRef();return s.useCallback(function(i){t.current=i,r.current&&A(r.current,null),r.current=e,e&&A(e,i)},[e])},M={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},j=function(t){Object.keys(M).forEach(function(e){t.style.setProperty(e,M[e],"important")})},m=null,Ie=function(t,e){var r=t.scrollHeight;return e.sizingStyle.boxSizing==="border-box"?r+e.borderSize:r-e.paddingSize};function Te(a,t,e,r){e===void 0&&(e=1),r===void 0&&(r=1/0),m||(m=document.createElement("textarea"),m.setAttribute("tabindex","-1"),m.setAttribute("aria-hidden","true"),j(m)),m.parentNode===null&&document.body.appendChild(m);var i=a.paddingSize,d=a.borderSize,h=a.sizingStyle,v=h.boxSizing;Object.keys(h).forEach(function(g){var x=g;m.style[x]=h[x]}),j(m),m.value=t;var l=Ie(m,a);m.value="x";var p=m.scrollHeight-i,c=p*e;v==="border-box"&&(c=c+i+d),l=Math.max(c,l);var f=p*r;return v==="border-box"&&(f=f+i+d),l=Math.min(f,l),[l,p]}var D=function(){},Be=function(t,e){return t.reduce(function(r,i){return r[i]=e[i],r},{})},Le=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak"],We=!!document.documentElement.currentStyle,He=function(t){var e=window.getComputedStyle(t);if(e===null)return null;var r=Be(Le,e),i=r.boxSizing;if(i==="")return null;We&&i==="border-box"&&(r.width=parseFloat(r.width)+parseFloat(r.borderRightWidth)+parseFloat(r.borderLeftWidth)+parseFloat(r.paddingRight)+parseFloat(r.paddingLeft)+"px");var d=parseFloat(r.paddingBottom)+parseFloat(r.paddingTop),h=parseFloat(r.borderBottomWidth)+parseFloat(r.borderTopWidth);return{sizingStyle:r,paddingSize:d,borderSize:h}},Fe=function(t){var e=Pe(t);s.useLayoutEffect(function(){var r=function(d){e.current(d)};return window.addEventListener("resize",r),function(){window.removeEventListener("resize",r)}},[])},ke=function(t,e){var r=t.cacheMeasurements,i=t.maxRows,d=t.minRows,h=t.onChange,v=h===void 0?D:h,l=t.onHeightChange,p=l===void 0?D:l,c=ae(t,["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"]),f=c.value!==void 0,g=s.useRef(null),x=Oe(g,e),b=s.useRef(0),C=s.useRef(),N=function(){var S=g.current,o=r&&C.current?C.current:He(S);if(o){C.current=o;var R=Te(o,S.value||S.placeholder||"x",d,i),_=R[0],I=R[1];b.current!==_&&(b.current=_,S.style.setProperty("height",_+"px","important"),p(_,{rowHeight:I}))}},z=function(S){f||N(),v(S)};return s.useLayoutEffect(N),Fe(N),s.createElement("textarea",ne({},c,{onChange:z,ref:x}))},Ae=s.forwardRef(ke);const Me=Ae;var je=ie(a=>({input:{paddingTop:a.spacing.xs,paddingBottom:a.spacing.xs}}));const De=je;var qe=Object.defineProperty,Ge=Object.defineProperties,Ve=Object.getOwnPropertyDescriptors,W=Object.getOwnPropertySymbols,J=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable,q=(a,t,e)=>t in a?qe(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,P=(a,t)=>{for(var e in t||(t={}))J.call(t,e)&&q(a,e,t[e]);if(W)for(var e of W(t))Q.call(t,e)&&q(a,e,t[e]);return a},H=(a,t)=>Ge(a,Ve(t)),$e=(a,t)=>{var e={};for(var r in a)J.call(a,r)&&t.indexOf(r)<0&&(e[r]=a[r]);if(a!=null&&W)for(var r of W(a))t.indexOf(r)<0&&Q.call(a,r)&&(e[r]=a[r]);return e};const Ue={autosize:!1,size:"sm",__staticSelector:"Textarea"},X=s.forwardRef((a,t)=>{const e=se("Textarea",Ue,a),{autosize:r,maxRows:i,minRows:d,label:h,error:v,description:l,id:p,className:c,required:f,style:g,wrapperProps:x,classNames:b,styles:C,size:N,__staticSelector:z,sx:O,errorProps:S,descriptionProps:o,labelProps:R,inputWrapperOrder:_,inputContainer:I,unstyled:u}=e,T=$e(e,["autosize","maxRows","minRows","label","error","description","id","className","required","style","wrapperProps","classNames","styles","size","__staticSelector","sx","errorProps","descriptionProps","labelProps","inputWrapperOrder","inputContainer","unstyled"]),E=oe(p),{classes:Z,cx:ee}=De(),{systemStyles:re,rest:te}=le(T),k=P({required:f,ref:t,invalid:!!v,id:E,classNames:H(P({},b),{input:ee(Z.input,b==null?void 0:b.input)}),styles:C,__staticSelector:z,size:N,multiline:!0,unstyled:u},te);return B.createElement(w.Wrapper,P(P({label:h,error:v,id:E,description:l,required:f,style:g,className:c,classNames:b,styles:C,size:N,__staticSelector:z,sx:O,errorProps:S,labelProps:R,descriptionProps:o,inputContainer:I,inputWrapperOrder:_,unstyled:u},re),x),r?B.createElement(w,H(P({},k),{component:Me,maxRows:i,minRows:d})):B.createElement(w,H(P({},k),{component:"textarea",rows:d})))});X.displayName="@mantine/core/Textarea";const G=({articleClassName:a,titleClassName:t,webtoonItemImg:e,webtoon:r})=>y("article",{className:a,children:[e,n("span",{className:t,children:r.title}),n("small",{children:r.service==="naver"?"네이버":r.service==="kakao"?"카카오":"카카오페이지"})]}),Ye=({isOpen:a,toggle:t})=>{const[e,r]=ce(),i=s.useRef(0),[d,h]=s.useState(""),[v,l]=s.useState(!0),p=de(d,500),{data:c,refetch:f,fetchNextPage:g}=ue({isSearch:!0,searchValue:p,pageRef:i}),{data:x}=he();pe(c,r,i,g),me(p,f,l,i,c);const[b,C]=s.useState(""),[N,z]=s.useState(""),[O,S]=s.useState(!1),[o,R]=s.useState(null);s.useEffect(()=>{if(o!==null)return S(!0)},[o]);const _=()=>{R(null),S(!1)},I=async()=>{const u={title:b,description:N,author:x==null?void 0:x._id,webtoon:o==null?void 0:o._id,service:o==null?void 0:o.service};b===""||N===""||o===null?L(ve,"yellow"):(await we(u)).RESULT===200&&(t(),C(""),z(""),R(null),L(be,"green"))};return y(fe,{title:"후기 작성",fullScreen:!0,overflow:"inside",opened:a,onClose:t,className:"create-board-modal-container",children:[n("div",{className:"create-board-input",children:o!==null&&n(G,{articleClassName:"selected-item",titleClassName:"searched-title",webtoon:o,webtoonItemImg:y("div",{className:"selected-img",children:[n("img",{src:o.img,width:100,height:100}),n("span",{className:"deleted-img",onClick:_,children:n(ge,{})})]})})}),n("div",{className:"create-board-input",children:n(w.Wrapper,{label:"웹툰 검색",required:!0,children:n(w,{disabled:o!==null,placeholder:"작품 또는 작가로 검색한 후 선택하세요.",value:d,onChange:u=>h(u.target.value)})})}),!O&&n("ul",{className:"search-result",children:v?y(F,{children:[c==null?void 0:c.pages.map((u,T)=>n(B.Fragment,{children:Array.isArray(u)&&(u==null?void 0:u.map(E=>n("li",{className:"searched-item-wrap",onClick:()=>R(E),children:n(G,{articleClassName:"searched-item",titleClassName:"searched-title",webtoonItemImg:n("img",{src:E.img,width:80,height:80}),webtoon:E})},E._id)))},T)),!!p&&n("div",{ref:e})]}):n(V,{className:"no-search-result",content:"검색 결과가 없습니다. 😥"})}),n("div",{className:"create-board-input",children:n(w.Wrapper,{label:"제목",required:!0,children:n(w,{placeholder:"후기 제목을 입력해주세요.",value:b,onChange:u=>{C(u.target.value)}})})}),n("div",{className:"create-board-input",children:n(w.Wrapper,{label:"내용",required:!0,children:n(X,{minRows:8,maxRows:12,placeholder:"후기 내용을 입력해주세요.",value:N,onChange:u=>{z(u.target.value)}})})}),n("div",{className:"create-board-btn",children:n("button",{onClick:I,children:"후기 작성"})})]})},Ke=()=>{const[a,t]=Se($),e=()=>{if(U(Y)===null){L(K,"yellow");return}else t(!a)};return y("div",{className:"create-board-container",children:[n("div",{className:"create-board-btn",onClick:e,children:n(ye,{})}),n(Ye,{isOpen:a,toggle:e})]})},Je=({pathname:a})=>xe([a],()=>ze(a)),rr=()=>{const{pathname:a}=Ne(),t=Ce(),e=Re($),{data:r,refetch:i,isLoading:d,isError:h}=Je({pathname:a});s.useEffect(()=>{i()},[e]);const v=l=>{U(Y)===null?L(K,"yellow"):t(`/board/detail/${l}`)};return d?n(_e,{}):h?n(F,{}):y("div",{className:"board-container",children:[r&&(r==null?void 0:r.length)===0?n(V,{className:"empty-board",content:y(F,{children:[n("h2",{children:a==="/board"?"후기가 아직 없어요. 😥":"해당하는 플랫폼의 후기가 아직 없어요. 😥"}),n("h4",{children:"기억에 남는 웹툰의 후기를 작성해보세요."})]})}):n("ul",{className:"board-list",children:r==null?void 0:r.map(({_id:l,title:p,author:c,description:f,webtoon:g})=>y("li",{className:"board",onClick:()=>v(l),children:[n("div",{className:"board-img-container",children:n("img",{src:g.img,className:"board-img"})}),y("div",{className:"board-description",children:[n("h4",{children:p}),y("h5",{children:[g.title," | ",g.author]}),y("div",{className:"creater",children:[n("span",{className:"board-author-img",children:n("img",{src:c.profileImage,width:28,height:28})}),"by",n("span",{className:"nickname",children:c.nickname})]}),n("p",{children:f})]})]},l))}),n(Ke,{})]})};export{rr as default};
