import{u as x,y as _,r as i,B as D,q as G,j as t,a,a5 as L,s as f,a6 as T,a7 as W}from"./index-a90ff333.js";import{S as g,A as q,G as B,p as F,i as j,u as V}from"./user-61e6e64d.js";import{I as l}from"./Input-e00903aa.js";import"./Input.styles-73bb39d9.js";const O=()=>{const{state:h}=x(),N=_(),s=h,d=i.useRef(),m=i.useRef(),k=D(G),[v,C]=i.useState(s.profileImage),[r,I]=i.useState(s.nickname),[c,b]=i.useState("empty"),[u,y]=i.useState(s.age),[p,S]=i.useState(s.gender),o=(e,n)=>{n==="nickname"?I(e.target.value):n==="age"?y(e):n==="gender"&&S(e)},R=async e=>{const n=new FormData;E(e.target.files[0]),n.append("images",e.target.files[0]),await F(s.id,n)},E=e=>{const n=new FileReader;return n.readAsDataURL(e),new Promise(A=>{n.onload=()=>{C(n.result),A()}})},P=e=>{e.preventDefault(),m.current.click()},U=async()=>{b(await j(r))},w=async()=>{const e={nickname:r,age:u,gender:p};if(c==="available"){const n=await V(s.id,e);n.RESULT===200&&(k(n.user),f(T,"green"),setTimeout(()=>{N("/")},1e3))}else d.current.focus(),f(W,"yellow")};return t("div",{className:"userinfo-container",children:[t("div",{className:"profile-img-container",children:[a(L,{size:120,src:v,radius:"xl",className:"profile-img"}),a("div",{style:{fontWeight:"bold"},children:s.email}),t("div",{className:"profile-img-edit",children:[a("input",{style:{display:"none"},ref:m,type:"file",className:"imgInput",accept:"image/*",name:"file",onChange:e=>R(e)}),a("button",{onClick:P,children:"사진 수정"})]})]}),t("div",{className:"profile-input",children:[t(l.Wrapper,{label:"닉네임",required:!0,children:[" ",t("span",{style:{fontSize:"12px"},children:["(",r.length,"/8자)"]}),a(l,{maxLength:8,placeholder:"닉네임을 입력하세요.",onChange:e=>o(e,"nickname"),defaultValue:r,ref:d})]}),t("div",{className:"nickname-check",children:[a("button",{onClick:e=>U(),children:"중복체크"}),c==="empty"?a("span",{className:"unavailable",children:"닉네임 중복체크를 해주세요."}):c==="available"?a("span",{className:"available",children:"사용할 수 있는 닉네임입니다."}):a("span",{className:"unavailable",children:"이미 사용중인 닉네임입니다."})]})]}),a("div",{className:"profile-input",children:a(l.Wrapper,{label:"나이",required:!0,children:a(g,{placeholder:"본인 연령대를 선택하세요.",data:q,defaultValue:u,onChange:e=>o(e,"age")})})}),a("div",{className:"profile-input",children:a(l.Wrapper,{label:"성별",required:!0,children:a(g,{placeholder:"성별을 선택하세요.",data:B,defaultValue:p,onChange:e=>o(e,"gender")})})}),a("div",{className:"profile-btn",children:a("button",{onClick:w,children:"프로필 수정하기"})})]})};export{O as default};
