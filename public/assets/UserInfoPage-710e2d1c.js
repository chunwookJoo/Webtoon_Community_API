import{h as w,N as A,r as s,j as a,i as x,F as D,a as l,a9 as F,aa as L,ab as G,l as u,ac as W,ad as _,ae as T}from"./index-54f6e4a3.js";import{S as h,p as j,i as q,u as B}from"./user-3c5fc80a.js";import{I as r}from"./Input-1f7e6f9a.js";import"./Input.styles-3abf4c20.js";const M=()=>{const{data:n,isLoading:f}=w(["userInfo"],()=>W());A();const d=s.useRef(),p=s.useRef(),[N,k]=s.useState(n==null?void 0:n.profileImage),[t,C]=s.useState(n==null?void 0:n.nickname),[c,v]=s.useState("empty"),[m,b]=s.useState(n==null?void 0:n.age),[g,y]=s.useState(n==null?void 0:n.gender),o=(e,i)=>{i==="nickname"?C(e.target.value):i==="age"?b(e):i==="gender"&&y(e)},P=async e=>{const i=new FormData;S(e.target.files[0]),i.append("images",e.target.files[0]),await j(n==null?void 0:n.id,i)},S=e=>{const i=new FileReader;return i.readAsDataURL(e),new Promise(U=>{i.onload=()=>{k(i.result),U()}})},E=e=>{e.preventDefault(),p.current.click()},I=async()=>{v(await q(t))},R=async()=>{const e={nickname:t,age:m,gender:g};if(c==="available"){if((await B(n.id,e)).RESULT===200)return u(_,"green")}else d.current.focus(),u(T,"yellow")};return f?a(x,{}):a(D,{children:n&&l("div",{className:"userinfo-container",children:[l("div",{className:"profile-img-container",children:[a(F,{size:120,src:N,radius:"xl",className:"profile-img"}),a("div",{style:{fontWeight:"bold"},children:n.email}),l("div",{className:"profile-img-edit",children:[a("input",{style:{display:"none"},ref:p,type:"file",className:"imgInput",accept:"image/*",name:"file",onChange:e=>P(e)}),a("button",{onClick:E,children:"사진 수정"})]})]}),l("div",{className:"profile-input",children:[l(r.Wrapper,{label:"닉네임",required:!0,children:[" ",l("span",{style:{fontSize:"12px"},children:["(",t==null?void 0:t.length,"/8자)"]}),a(r,{maxLength:8,placeholder:"닉네임을 입력하세요.",onChange:e=>o(e,"nickname"),defaultValue:t,ref:d})]}),l("div",{className:"nickname-check",children:[a("button",{onClick:e=>I(),children:"중복체크"}),c==="empty"?a("span",{className:"unavailable",children:"닉네임 중복체크를 해주세요."}):c==="available"?a("span",{className:"available",children:"사용할 수 있는 닉네임입니다."}):a("span",{className:"unavailable",children:"이미 사용중인 닉네임입니다."})]})]}),a("div",{className:"profile-input",children:a(r.Wrapper,{label:"나이",required:!0,children:a(h,{placeholder:"본인 연령대를 선택하세요.",data:L,defaultValue:m,onChange:e=>o(e,"age")})})}),a("div",{className:"profile-input",children:a(r.Wrapper,{label:"성별",required:!0,children:a(h,{placeholder:"성별을 선택하세요.",data:G,defaultValue:g,onChange:e=>o(e,"gender")})})}),a("div",{className:"profile-btn",children:a("button",{onClick:R,children:"프로필 수정하기"})})]})})};export{M as default};
