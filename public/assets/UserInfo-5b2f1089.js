import{u as W,p as _,r as t,m as j,n as q,j as i,a,H as F,b as m,A as p,s as k}from"./index-1062e1fd.js";import{I as r}from"./Input-c8df33ff.js";import{S as b}from"./Select-e8f5c743.js";import"./Input.styles-3b5c053d.js";const J=()=>{const{state:N}=W(),C=_(),l=N,f=t.useRef(),h=t.useRef(),I=[{value:"10~19",label:"10대"},{value:"20~29",label:"20대"},{value:"30~39",label:"30대"},{value:"40~49",label:"40대"},{value:"50~59",label:"50대"},{value:"60~69",label:"60대"}],R=[{value:"male",label:"남자"},{value:"female",label:"여자"}],[V,S]=j(q),[y,U]=t.useState(l.profileImage),[s,x]=t.useState(l.nickname),[o,c]=t.useState("empty"),[g,E]=t.useState(l.age),[v,L]=t.useState(l.gender),d=(e,n)=>{n==="nickname"?x(e.target.value):n==="age"?E(e):n==="gender"&&L(e)},A=async e=>{const n=new FormData;P(e.target.files[0]),n.append("images",e.target.files[0]),m({baseURL:p,url:`/auth/userinfo/profileimg/upload/${l.id}`,method:"POST",data:n,headers:{"Content-Type":"multipart/form-data"}}).then(u=>{console.log(u)})},P=e=>{const n=new FileReader;return n.readAsDataURL(e),new Promise(u=>{n.onload=()=>{U(n.result),u()}})},T=e=>{e.preventDefault(),h.current.click()},w={nickname:s},D=()=>{if(s===""){c("empty");return}else m.post(p+"/auth/nickname/check",w).then(e=>{if(e.data.RESULT===200){c("available");return}else if(e.data.RESULT===403){c("unavailable");return}})},B={nickname:s,age:g,gender:v},G=()=>{o==="available"?m.post(p+`/auth/userinfo/update/${l.id}`,B).then(e=>{e.data.RESULT===200&&(S(e.data.user),k({message:"프로필이 수정되었습니다.",autoClose:2e3,radius:"md",color:"green"}),setTimeout(()=>{C("/")},1e3))}):(f.current.focus(),k({message:"닉네임 중복체크를 해주세요.",autoClose:2e3,radius:"md",color:"red"}))};return i("div",{className:"userinfo-container",children:[i("div",{className:"profile-img-container",children:[a(F,{size:120,src:y,radius:"xl",className:"profile-img"}),a("div",{style:{fontWeight:"bold"},children:l.email}),i("div",{className:"profile-img-edit",children:[a("input",{style:{display:"none"},ref:h,type:"file",className:"imgInput",accept:"image/*",name:"file",onChange:e=>A(e)}),a("button",{onClick:T,children:"사진 수정"})]})]}),i("div",{className:"profile-input",children:[i(r.Wrapper,{label:"닉네임",required:!0,children:[" ",i("span",{style:{fontSize:"12px"},children:["(",s.length,"/8자)"]}),a(r,{maxLength:8,placeholder:"닉네임을 입력하세요.",onChange:e=>d(e,"nickname"),defaultValue:s,ref:f})]}),i("div",{className:"nickname-check",children:[a("button",{onClick:e=>D(),children:"중복체크"}),o==="empty"?a("span",{className:"unavailable",children:"닉네임 중복체크를 해주세요."}):o==="available"?a("span",{className:"available",children:"사용할 수 있는 닉네임입니다."}):a("span",{className:"unavailable",children:"이미 사용중인 닉네임입니다."})]})]}),a("div",{className:"profile-input",children:a(r.Wrapper,{label:"나이",required:!0,children:a(b,{placeholder:"본인 연령대를 선택하세요.",data:I,defaultValue:g,onChange:e=>d(e,"age")})})}),a("div",{className:"profile-input",children:a(r.Wrapper,{label:"성별",required:!0,children:a(b,{placeholder:"성별을 선택하세요.",data:R,defaultValue:v,onChange:e=>d(e,"gender")})})}),a("div",{className:"profile-btn",children:a("button",{onClick:G,children:"프로필 수정하기"})})]})};export{J as default};
