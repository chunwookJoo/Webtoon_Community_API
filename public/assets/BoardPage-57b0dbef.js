import{r as o,_ as ae,f as ne,h as ie,i as oe,k as se,l as le,R as $,m as T,n as ce,b as K,A as U,a as n,j as S,c as de,L as ue,M as he,z as pe,F as ge,s as B,o as Q,E as me,p as fe,u as ve,q as be}from"./index-1062e1fd.js";import{b as Se,a as ye}from"./recoilBoardState-e0973af9.js";import{I as _}from"./Input-c8df33ff.js";import"./Input.styles-3b5c053d.js";var we=o.useLayoutEffect,xe=function(t){var e=o.useRef(t);return we(function(){e.current=t}),e},Y=function(t,e){if(typeof t=="function"){t(e);return}t.current=e},Ne=function(t,e){var r=o.useRef();return o.useCallback(function(s){t.current=s,r.current&&Y(r.current,null),r.current=e,e&&Y(e,s)},[e])},G={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},J=function(t){Object.keys(G).forEach(function(e){t.style.setProperty(e,G[e],"important")})},f=null,Ce=function(t,e){var r=t.scrollHeight;return e.sizingStyle.boxSizing==="border-box"?r+e.borderSize:r-e.paddingSize};function ze(a,t,e,r){e===void 0&&(e=1),r===void 0&&(r=1/0),f||(f=document.createElement("textarea"),f.setAttribute("tabindex","-1"),f.setAttribute("aria-hidden","true"),J(f)),f.parentNode===null&&document.body.appendChild(f);var s=a.paddingSize,c=a.borderSize,d=a.sizingStyle,v=d.boxSizing;Object.keys(d).forEach(function(h){var x=h;f.style[x]=d[x]}),J(f),f.value=t;var u=Ce(f,a);f.value="x";var b=f.scrollHeight-s,p=b*e;v==="border-box"&&(p=p+s+c),u=Math.max(p,u);var i=b*r;return v==="border-box"&&(i=i+s+c),u=Math.min(i,u),[u,b]}var X=function(){},_e=function(t,e){return t.reduce(function(r,s){return r[s]=e[s],r},{})},Re=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak"],Ee=!!document.documentElement.currentStyle,Pe=function(t){var e=window.getComputedStyle(t);if(e===null)return null;var r=_e(Re,e),s=r.boxSizing;if(s==="")return null;Ee&&s==="border-box"&&(r.width=parseFloat(r.width)+parseFloat(r.borderRightWidth)+parseFloat(r.borderLeftWidth)+parseFloat(r.paddingRight)+parseFloat(r.paddingLeft)+"px");var c=parseFloat(r.paddingBottom)+parseFloat(r.paddingTop),d=parseFloat(r.borderBottomWidth)+parseFloat(r.borderTopWidth);return{sizingStyle:r,paddingSize:c,borderSize:d}},Oe=function(t){var e=xe(t);o.useLayoutEffect(function(){var r=function(c){e.current(c)};return window.addEventListener("resize",r),function(){window.removeEventListener("resize",r)}},[])},Te=function(t,e){var r=t.cacheMeasurements,s=t.maxRows,c=t.minRows,d=t.onChange,v=d===void 0?X:d,u=t.onHeightChange,b=u===void 0?X:u,p=ae(t,["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"]),i=p.value!==void 0,h=o.useRef(null),x=Ne(h,e),N=o.useRef(0),y=o.useRef(),C=function(){var g=h.current,P=r&&y.current?y.current:Pe(g);if(P){y.current=P;var l=ze(P,g.value||g.placeholder||"x",c,s),w=l[0],L=l[1];N.current!==w&&(N.current=w,g.style.setProperty("height",w+"px","important"),b(w,{rowHeight:L}))}},E=function(g){i||C(),v(g)};return o.useLayoutEffect(C),Oe(C),o.createElement("textarea",ne({},p,{onChange:E,ref:x}))},Le=o.forwardRef(Te);const ke=Le;var We=ie(a=>({input:{paddingTop:a.spacing.xs,paddingBottom:a.spacing.xs}}));const Be=We;var He=Object.defineProperty,Ie=Object.defineProperties,Me=Object.getOwnPropertyDescriptors,H=Object.getOwnPropertySymbols,ee=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable,Z=(a,t,e)=>t in a?He(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,O=(a,t)=>{for(var e in t||(t={}))ee.call(t,e)&&Z(a,e,t[e]);if(H)for(var e of H(t))te.call(t,e)&&Z(a,e,t[e]);return a},q=(a,t)=>Ie(a,Me(t)),je=(a,t)=>{var e={};for(var r in a)ee.call(a,r)&&t.indexOf(r)<0&&(e[r]=a[r]);if(a!=null&&H)for(var r of H(a))t.indexOf(r)<0&&te.call(a,r)&&(e[r]=a[r]);return e};const Fe={autosize:!1,size:"sm",__staticSelector:"Textarea"},re=o.forwardRef((a,t)=>{const e=oe("Textarea",Fe,a),{autosize:r,maxRows:s,minRows:c,label:d,error:v,description:u,id:b,className:p,required:i,style:h,wrapperProps:x,classNames:N,styles:y,size:C,__staticSelector:E,sx:z,errorProps:g,descriptionProps:P,labelProps:l,inputWrapperOrder:w,inputContainer:L,unstyled:I}=e,M=je(e,["autosize","maxRows","minRows","label","error","description","id","className","required","style","wrapperProps","classNames","styles","size","__staticSelector","sx","errorProps","descriptionProps","labelProps","inputWrapperOrder","inputContainer","unstyled"]),k=se(b),{classes:j,cx:F}=Be(),{systemStyles:A,rest:D}=le(M),V=O({required:i,ref:t,invalid:!!v,id:k,classNames:q(O({},N),{input:F(j.input,N==null?void 0:N.input)}),styles:y,__staticSelector:E,size:C,multiline:!0,unstyled:I},D);return $.createElement(_.Wrapper,O(O({label:d,error:v,id:k,description:u,required:i,style:h,className:p,classNames:N,styles:y,size:C,__staticSelector:E,sx:z,errorProps:g,labelProps:l,descriptionProps:P,inputContainer:L,inputWrapperOrder:w,unstyled:I},A),x),r?$.createElement(_,q(O({},V),{component:ke,maxRows:s,minRows:c})):$.createElement(_,q(O({},V),{component:"textarea",rows:c})))});re.displayName="@mantine/core/Textarea";const Ae=a=>{const t=a.isOpen,e=a.toggle,r=n(ge,{}),s=[n("li",{className:"no-search-result",children:"검색 결과가 없습니다. 😥"})],[c,d]=o.useState(""),[v,u]=o.useState(""),[b,p]=o.useState(""),[i,h]=o.useState(""),[x,N]=o.useState(!0);let y=2;const C=y*12,[E,z]=o.useState([]),[g,P]=o.useState([]),[l,w]=o.useState(null),[L,I]=T(ce);o.useEffect(()=>{v?(async()=>{const{data:m}=await K.get(`${U}/search?keyword=${v}`);Array.isArray(m)?z(m.map((R,W)=>n("li",{className:"searched-item-wrap",onClick:()=>w(R),children:S("article",{className:"searched-item",children:[n("img",{src:R.img,width:80,height:80}),n("span",{className:"searched-title",children:R.title}),n("small",{children:R.service==="naver"?"네이버":R.service==="kakao"?"카카오":"카카오페이지"})]})},W))):z(s)})():z([])},[v]),o.useEffect(()=>{l!==null&&z([])},[l]);const M=()=>{w(null)},k={title:b,description:i,author:L._id,webtoon:l==null?void 0:l._id,service:l==null?void 0:l.service},j=()=>{b===""||i===""||l===null?B({message:"모두 입력해주세요.",autoClose:1500,radius:"md",color:"yellow"}):K.post(U+"/api/board/create",k).then(m=>{m.data.RESULT===200?(e(),p(""),h(""),w(null),B({message:"후기가 정상적으로 작성되었습니다.",autoClose:2e3,radius:"md",color:"green"})):console.log(m)})},[F,A]=de();A&&y++;const D=C<g.length&&24<=g.length?n("li",{ref:F,className:"loading",children:n(ue,{})}):r;return g.slice(0,y*12).push(D),S(he,{title:"후기 작성",fullScreen:!0,overflow:"inside",opened:t,onClose:e,className:"create-board-modal-container",children:[n("div",{className:"create-board-input",children:l===null?"":S("article",{className:"selected-item",children:[S("div",{className:"selected-img",children:[n("img",{src:l.img,width:100,height:100}),n("span",{className:"deleted-img",onClick:M,children:n(pe,{})})]}),n("span",{className:"searched-title",children:l.title}),n("small",{children:l.service==="naver"?"네이버":l.service==="kakao"?"카카오":"카카오페이지"})]})}),n("div",{className:"create-board-input",children:n(_.Wrapper,{label:"웹툰 검색",required:!0,children:n(_,{disabled:l!==null,placeholder:"작품 또는 작가로 검색한 후 선택하세요.",data:g,value:c,onChange:m=>{N(!0),d(m.target.value);const R=m.target.value;setTimeout(()=>{const W=m.target.value;W===R&&u(W)},500)}})})}),n("ul",{className:"search-result",children:E}),n("div",{className:"create-board-input",children:n(_.Wrapper,{label:"제목",required:!0,children:n(_,{placeholder:"후기 제목을 입력해주세요.",value:b,onChange:m=>{p(m.target.value)}})})}),n("div",{className:"create-board-input",children:n(_.Wrapper,{label:"내용",required:!0,children:n(re,{minRows:8,maxRows:12,placeholder:"후기 내용을 입력해주세요.",value:i,onChange:m=>{h(m.target.value)}})})}),n("div",{className:"create-board-btn",children:n("button",{onClick:j,children:"후기 작성"})})]})},De=()=>{const[a,t]=T(Q),e=()=>{if(localStorage.getItem("userId")===null){B({message:"로그인을 먼저 해주세요.",autoClose:1500,radius:"md",color:"yellow"});return}else t(!a)};return S("div",{className:"create-board-container",children:[n("div",{className:"create-board-btn",onClick:e,children:n(me,{})}),n(Ae,{isOpen:a,toggle:e})]})};const Ue=()=>{const a=fe(),{state:t}=ve(),[e,r]=T(Se),[s,c]=T(ye),[d,v]=T(be),[u,b]=T(Q);o.useEffect(()=>{K.get(U+(t===null?"/api/board":"/api"+t)).then(i=>{r(i.data)})},[t,u]);const p=(i,h)=>{d===null?B({message:"로그인을 먼저 해주세요.",autoClose:1500,radius:"md",color:"yellow"}):(c(h),a("/board/detail",{state:h._id}))};return S("div",{className:"board-container",children:[(e==null?void 0:e.length)===0?S("div",{className:"empty-board",children:[n("h2",{children:t==="/board"?"후기가 아직 없어요 😥":"해당하는 플랫폼의 후기가 아직 없어요 😥"}),n("h4",{children:"기억에 남는 웹툰의 후기를 작성해보세요."})]}):n("ul",{className:"board-list",children:e==null?void 0:e.map((i,h)=>S("li",{className:"board",onClick:x=>p(x,i),children:[n("div",{className:"board-img-container",children:n("img",{src:i.webtoon.img,className:"board-img"})}),S("div",{className:"board-description",children:[n("h4",{children:i.title}),S("h5",{children:[i.webtoon.title," | ",i.webtoon.author]}),S("div",{className:"creater",children:[n("span",{className:"board-author-img",children:n("img",{src:i.author.profileImage,width:28,height:28})}),"by",n("span",{className:"nickname",children:i.author.nickname})]}),n("p",{children:i.description})]})]},h))}),n(De,{})]})};export{Ue as default};
