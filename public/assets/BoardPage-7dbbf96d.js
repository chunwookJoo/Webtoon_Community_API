import{r as o,_ as ne,o as ie,q as se,t as oe,v as le,w as ce,x as T,d as de,y as ue,e as he,f as pe,z as fe,B as G,a as g,M as me,j as n,C as ge,F as U,E as V,l as L,D as ve,G as be,H as $,J as Y,K as Se,k as K,U as ye,I as J,N as xe,u as Ne,R as _e,O as Re}from"./index-54f6e4a3.js";import{p as we,b as Ce,a as ze,g as Ee}from"./recoilBoardState-ac5b2653.js";import{u as Pe}from"./recoilAuthState-d31f17b1.js";import{I as w}from"./Input-1f7e6f9a.js";import"./Input.styles-3abf4c20.js";var Ie=o.useLayoutEffect,Oe=function(t){var e=o.useRef(t);return Ie(function(){e.current=t}),e},k=function(t,e){if(typeof t=="function"){t(e);return}t.current=e},Be=function(t,e){var r=o.useRef();return o.useCallback(function(i){t.current=i,r.current&&k(r.current,null),r.current=e,e&&k(e,i)},[e])},A={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},D=function(t){Object.keys(A).forEach(function(e){t.style.setProperty(e,A[e],"important")})},m=null,Te=function(t,e){var r=t.scrollHeight;return e.sizingStyle.boxSizing==="border-box"?r+e.borderSize:r-e.paddingSize};function Le(a,t,e,r){e===void 0&&(e=1),r===void 0&&(r=1/0),m||(m=document.createElement("textarea"),m.setAttribute("tabindex","-1"),m.setAttribute("aria-hidden","true"),D(m)),m.parentNode===null&&document.body.appendChild(m);var i=a.paddingSize,d=a.borderSize,h=a.sizingStyle,l=h.boxSizing;Object.keys(h).forEach(function(_){var b=_;m.style[b]=h[b]}),D(m),m.value=t;var c=Te(m,a);m.value="x";var f=m.scrollHeight-i,p=f*e;l==="border-box"&&(p=p+i+d),c=Math.max(p,c);var v=f*r;return l==="border-box"&&(v=v+i+d),c=Math.min(v,c),[c,f]}var M=function(){},We=function(t,e){return t.reduce(function(r,i){return r[i]=e[i],r},{})},He=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak"],Fe=!!document.documentElement.currentStyle,ke=function(t){var e=window.getComputedStyle(t);if(e===null)return null;var r=We(He,e),i=r.boxSizing;if(i==="")return null;Fe&&i==="border-box"&&(r.width=parseFloat(r.width)+parseFloat(r.borderRightWidth)+parseFloat(r.borderLeftWidth)+parseFloat(r.paddingRight)+parseFloat(r.paddingLeft)+"px");var d=parseFloat(r.paddingBottom)+parseFloat(r.paddingTop),h=parseFloat(r.borderBottomWidth)+parseFloat(r.borderTopWidth);return{sizingStyle:r,paddingSize:d,borderSize:h}},Ae=function(t){var e=Oe(t);o.useLayoutEffect(function(){var r=function(d){e.current(d)};return window.addEventListener("resize",r),function(){window.removeEventListener("resize",r)}},[])},De=function(t,e){var r=t.cacheMeasurements,i=t.maxRows,d=t.minRows,h=t.onChange,l=h===void 0?M:h,c=t.onHeightChange,f=c===void 0?M:c,p=ne(t,["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"]),v=p.value!==void 0,_=o.useRef(null),b=Be(_,e),S=o.useRef(0),y=o.useRef(),x=function(){var s=_.current,N=r&&y.current?y.current:ke(s);if(N){y.current=N;var P=Le(N,s.value||s.placeholder||"x",d,i),R=P[0],O=P[1];S.current!==R&&(S.current=R,s.style.setProperty("height",R+"px","important"),f(R,{rowHeight:O}))}},z=function(s){v||x(),l(s)};return o.useLayoutEffect(x),Ae(x),o.createElement("textarea",ie({},p,{onChange:z,ref:b}))},Me=o.forwardRef(De);const je=Me;var qe=se(a=>({input:{paddingTop:a.spacing.xs,paddingBottom:a.spacing.xs}}));const Ge=qe;var Ue=Object.defineProperty,Ve=Object.defineProperties,$e=Object.getOwnPropertyDescriptors,W=Object.getOwnPropertySymbols,X=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable,j=(a,t,e)=>t in a?Ue(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,I=(a,t)=>{for(var e in t||(t={}))X.call(t,e)&&j(a,e,t[e]);if(W)for(var e of W(t))Z.call(t,e)&&j(a,e,t[e]);return a},H=(a,t)=>Ve(a,$e(t)),Ye=(a,t)=>{var e={};for(var r in a)X.call(a,r)&&t.indexOf(r)<0&&(e[r]=a[r]);if(a!=null&&W)for(var r of W(a))t.indexOf(r)<0&&Z.call(a,r)&&(e[r]=a[r]);return e};const Ke={autosize:!1,size:"sm",__staticSelector:"Textarea"},Q=o.forwardRef((a,t)=>{const e=oe("Textarea",Ke,a),{autosize:r,maxRows:i,minRows:d,label:h,error:l,description:c,id:f,className:p,required:v,style:_,wrapperProps:b,classNames:S,styles:y,size:x,__staticSelector:z,sx:E,errorProps:s,descriptionProps:N,labelProps:P,inputWrapperOrder:R,inputContainer:O,unstyled:u}=e,B=Ye(e,["autosize","maxRows","minRows","label","error","description","id","className","required","style","wrapperProps","classNames","styles","size","__staticSelector","sx","errorProps","descriptionProps","labelProps","inputWrapperOrder","inputContainer","unstyled"]),C=le(f),{classes:ee,cx:te}=Ge(),{systemStyles:re,rest:ae}=ce(B),F=I({required:v,ref:t,invalid:!!l,id:C,classNames:H(I({},S),{input:te(ee.input,S==null?void 0:S.input)}),styles:y,__staticSelector:z,size:x,multiline:!0,unstyled:u},ae);return T.createElement(w.Wrapper,I(I({label:h,error:l,id:C,description:c,required:v,style:_,className:p,classNames:S,styles:y,size:x,__staticSelector:z,sx:E,errorProps:s,labelProps:P,descriptionProps:N,inputContainer:O,inputWrapperOrder:R,unstyled:u},re),b),r?T.createElement(w,H(I({},F),{component:je,maxRows:i,minRows:d})):T.createElement(w,H(I({},F),{component:"textarea",rows:d})))});Q.displayName="@mantine/core/Textarea";const q=({articleClassName:a,titleClassName:t,webtoonItemImg:e,webtoon:r})=>g("article",{className:a,children:[e,n("span",{className:t,children:r.title}),n("small",{children:r.service==="naver"?"네이버":r.service==="kakao"?"카카오":"카카오페이지"})]}),Je=({isOpen:a,toggle:t})=>{const[e,r]=de(),i=o.useRef(0),[d,h]=o.useState(""),[l,c]=o.useState(!0),f=ue(d,500),{data:p,refetch:v,fetchNextPage:_}=he({isSearch:!0,searchValue:f,pageRef:i});pe(p,r,i,_),fe(f,v,c,i,p);const[b,S]=o.useState(""),[y,x]=o.useState(""),[z,E]=o.useState(!1),[s,N]=o.useState(null),P=G(Pe);o.useEffect(()=>{if(s!==null)return E(!0)},[s]);const R=()=>{N(null),E(!1)},O=async()=>{const u={title:b,description:y,author:P._id,webtoon:s==null?void 0:s._id,service:s==null?void 0:s.service};b===""||y===""||s===null?L(ve,"yellow"):(await we(u)).RESULT===200&&(t(),S(""),x(""),N(null),L(be,"green"))};return g(me,{title:"후기 작성",fullScreen:!0,overflow:"inside",opened:a,onClose:t,className:"create-board-modal-container",children:[n("div",{className:"create-board-input",children:s!==null&&n(q,{articleClassName:"selected-item",titleClassName:"searched-title",webtoon:s,webtoonItemImg:g("div",{className:"selected-img",children:[n("img",{src:s.img,width:100,height:100}),n("span",{className:"deleted-img",onClick:R,children:n(ge,{})})]})})}),n("div",{className:"create-board-input",children:n(w.Wrapper,{label:"웹툰 검색",required:!0,children:n(w,{disabled:s!==null,placeholder:"작품 또는 작가로 검색한 후 선택하세요.",value:d,onChange:u=>h(u.target.value)})})}),!z&&n("ul",{className:"search-result",children:l?g(U,{children:[p==null?void 0:p.pages.map((u,B)=>n(T.Fragment,{children:Array.isArray(u)&&(u==null?void 0:u.map(C=>n("li",{className:"searched-item-wrap",onClick:()=>N(C),children:n(q,{articleClassName:"searched-item",titleClassName:"searched-title",webtoonItemImg:n("img",{src:C.img,width:80,height:80}),webtoon:C})},C._id)))},B)),!!f&&n("div",{ref:e})]}):n(V,{className:"no-search-result",content:"검색 결과가 없습니다. 😥"})}),n("div",{className:"create-board-input",children:n(w.Wrapper,{label:"제목",required:!0,children:n(w,{placeholder:"후기 제목을 입력해주세요.",value:b,onChange:u=>{S(u.target.value)}})})}),n("div",{className:"create-board-input",children:n(w.Wrapper,{label:"내용",required:!0,children:n(Q,{minRows:8,maxRows:12,placeholder:"후기 내용을 입력해주세요.",value:y,onChange:u=>{x(u.target.value)}})})}),n("div",{className:"create-board-btn",children:n("button",{onClick:O,children:"후기 작성"})})]})},Xe=()=>{const[a,t]=$(Y),e=()=>{if(K(ye)===null){L(J,"yellow");return}else t(!a)};return g("div",{className:"create-board-container",children:[n("div",{className:"create-board-btn",onClick:e,children:n(Se,{})}),n(Je,{isOpen:a,toggle:e})]})},at=()=>{const a=xe(),{state:t}=Ne(),[e,r]=$(Ce),i=_e(ze),d=G(Y);o.useEffect(()=>{(async()=>{if(t){const c=await Ee(t);r(c)}})()},[t,d]);const h=(l,c)=>{K(Re)===null?L(J,"yellow"):(i(c),a("/board/detail",{state:c._id}))};return g("div",{className:"board-container",children:[(e==null?void 0:e.length)===0?n(V,{className:"empty-board",content:g(U,{children:[n("h2",{children:t==="/board"?"후기가 아직 없어요. 😥":"해당하는 플랫폼의 후기가 아직 없어요. 😥"}),n("h4",{children:"기억에 남는 웹툰의 후기를 작성해보세요."})]})}):n("ul",{className:"board-list",children:e==null?void 0:e.map((l,c)=>g("li",{className:"board",onClick:f=>h(f,l),children:[n("div",{className:"board-img-container",children:n("img",{src:l.webtoon.img,className:"board-img"})}),g("div",{className:"board-description",children:[n("h4",{children:l.title}),g("h5",{children:[l.webtoon.title," | ",l.webtoon.author]}),g("div",{className:"creater",children:[n("span",{className:"board-author-img",children:n("img",{src:l.author.profileImage,width:28,height:28})}),"by",n("span",{className:"nickname",children:l.author.nickname})]}),n("p",{children:l.description})]})]},c))}),n(Xe,{})]})};export{at as default};
