import{r as s,_ as ae,n as ne,o as ie,q as se,t as oe,v as le,w as B,c as ce,x as de,d as ue,y as he,e as pe,z as me,a as y,M as fe,j as n,B as ge,F,E as V,k as L,C as ve,D as be,G as Se,H as $,J as ye,i as U,K as Y,I as K,f as xe,u as Ne,N as Ce,O as Re,h as _e}from"./index-c267ac38.js";import{p as ze,g as we}from"./board-2962c721.js";import{I as w}from"./Input-37f9e835.js";import"./Input.styles-f3bcd6a5.js";var Ee=s.useLayoutEffect,Pe=function(r){var e=s.useRef(r);return Ee(function(){e.current=r}),e},A=function(r,e){if(typeof r=="function"){r(e);return}r.current=e},Oe=function(r,e){var t=s.useRef();return s.useCallback(function(i){r.current=i,t.current&&A(t.current,null),t.current=e,e&&A(e,i)},[e])},M={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},j=function(r){Object.keys(M).forEach(function(e){r.style.setProperty(e,M[e],"important")})},f=null,Ie=function(r,e){var t=r.scrollHeight;return e.sizingStyle.boxSizing==="border-box"?t+e.borderSize:t-e.paddingSize};function Te(a,r,e,t){e===void 0&&(e=1),t===void 0&&(t=1/0),f||(f=document.createElement("textarea"),f.setAttribute("tabindex","-1"),f.setAttribute("aria-hidden","true"),j(f)),f.parentNode===null&&document.body.appendChild(f);var i=a.paddingSize,d=a.borderSize,h=a.sizingStyle,v=h.boxSizing;Object.keys(h).forEach(function(m){var x=m;f.style[x]=h[x]}),j(f),f.value=r;var l=Ie(f,a);f.value="x";var p=f.scrollHeight-i,c=p*e;v==="border-box"&&(c=c+i+d),l=Math.max(c,l);var g=p*t;return v==="border-box"&&(g=g+i+d),l=Math.min(g,l),[l,p]}var D=function(){},Be=function(r,e){return r.reduce(function(t,i){return t[i]=e[i],t},{})},Le=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak"],We=!!document.documentElement.currentStyle,He=function(r){var e=window.getComputedStyle(r);if(e===null)return null;var t=Be(Le,e),i=t.boxSizing;if(i==="")return null;We&&i==="border-box"&&(t.width=parseFloat(t.width)+parseFloat(t.borderRightWidth)+parseFloat(t.borderLeftWidth)+parseFloat(t.paddingRight)+parseFloat(t.paddingLeft)+"px");var d=parseFloat(t.paddingBottom)+parseFloat(t.paddingTop),h=parseFloat(t.borderBottomWidth)+parseFloat(t.borderTopWidth);return{sizingStyle:t,paddingSize:d,borderSize:h}},Fe=function(r){var e=Pe(r);s.useLayoutEffect(function(){var t=function(d){e.current(d)};return window.addEventListener("resize",t),function(){window.removeEventListener("resize",t)}},[])},ke=function(r,e){var t=r.cacheMeasurements,i=r.maxRows,d=r.minRows,h=r.onChange,v=h===void 0?D:h,l=r.onHeightChange,p=l===void 0?D:l,c=ae(r,["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"]),g=c.value!==void 0,m=s.useRef(null),x=Oe(m,e),b=s.useRef(0),C=s.useRef(),N=function(){var S=m.current,o=t&&C.current?C.current:He(S);if(o){C.current=o;var R=Te(o,S.value||S.placeholder||"x",d,i),_=R[0],I=R[1];b.current!==_&&(b.current=_,S.style.setProperty("height",_+"px","important"),p(_,{rowHeight:I}))}},E=function(S){g||N(),v(S)};return s.useLayoutEffect(N),Fe(N),s.createElement("textarea",ne({},c,{onChange:E,ref:x}))},Ae=s.forwardRef(ke);const Me=Ae;var je=ie(a=>({input:{paddingTop:a.spacing.xs,paddingBottom:a.spacing.xs}}));const De=je;var qe=Object.defineProperty,Ge=Object.defineProperties,Ve=Object.getOwnPropertyDescriptors,W=Object.getOwnPropertySymbols,J=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable,q=(a,r,e)=>r in a?qe(a,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[r]=e,P=(a,r)=>{for(var e in r||(r={}))J.call(r,e)&&q(a,e,r[e]);if(W)for(var e of W(r))Q.call(r,e)&&q(a,e,r[e]);return a},H=(a,r)=>Ge(a,Ve(r)),$e=(a,r)=>{var e={};for(var t in a)J.call(a,t)&&r.indexOf(t)<0&&(e[t]=a[t]);if(a!=null&&W)for(var t of W(a))r.indexOf(t)<0&&Q.call(a,t)&&(e[t]=a[t]);return e};const Ue={autosize:!1,size:"sm",__staticSelector:"Textarea"},X=s.forwardRef((a,r)=>{const e=se("Textarea",Ue,a),{autosize:t,maxRows:i,minRows:d,label:h,error:v,description:l,id:p,className:c,required:g,style:m,wrapperProps:x,classNames:b,styles:C,size:N,__staticSelector:E,sx:O,errorProps:S,descriptionProps:o,labelProps:R,inputWrapperOrder:_,inputContainer:I,unstyled:u}=e,T=$e(e,["autosize","maxRows","minRows","label","error","description","id","className","required","style","wrapperProps","classNames","styles","size","__staticSelector","sx","errorProps","descriptionProps","labelProps","inputWrapperOrder","inputContainer","unstyled"]),z=oe(p),{classes:Z,cx:ee}=De(),{systemStyles:te,rest:re}=le(T),k=P({required:g,ref:r,invalid:!!v,id:z,classNames:H(P({},b),{input:ee(Z.input,b==null?void 0:b.input)}),styles:C,__staticSelector:E,size:N,multiline:!0,unstyled:u},re);return B.createElement(w.Wrapper,P(P({label:h,error:v,id:z,description:l,required:g,style:m,className:c,classNames:b,styles:C,size:N,__staticSelector:E,sx:O,errorProps:S,labelProps:R,descriptionProps:o,inputContainer:I,inputWrapperOrder:_,unstyled:u},te),x),t?B.createElement(w,H(P({},k),{component:Me,maxRows:i,minRows:d})):B.createElement(w,H(P({},k),{component:"textarea",rows:d})))});X.displayName="@mantine/core/Textarea";const G=({articleClassName:a,titleClassName:r,webtoonItemImg:e,webtoon:t})=>y("article",{className:a,children:[e,n("span",{className:r,children:t.title}),n("small",{children:t.service==="naver"?"네이버":t.service==="kakao"?"카카오":"카카오페이지"})]}),Ye=({isOpen:a,toggle:r})=>{const[e,t]=ce(),i=s.useRef(0),[d,h]=s.useState(""),[v,l]=s.useState(!0),p=de(d,500),{data:c,refetch:g,fetchNextPage:m}=ue({isSearch:!0,searchValue:p,pageRef:i}),{data:x}=he();pe(c,t,i,m),me(p,g,l,i,c);const[b,C]=s.useState(""),[N,E]=s.useState(""),[O,S]=s.useState(!1),[o,R]=s.useState(null);s.useEffect(()=>{if(o!==null)return S(!0)},[o]);const _=()=>{R(null),S(!1)},I=async()=>{const u={title:b,description:N,author:x==null?void 0:x._id,webtoon:o==null?void 0:o._id,service:o==null?void 0:o.service};b===""||N===""||o===null?L(ve,"yellow"):(await ze(u)).RESULT===200&&(r(),C(""),E(""),R(null),L(be,"green"))};return y(fe,{title:"후기 작성",fullScreen:!0,overflow:"inside",opened:a,onClose:r,className:"create-board-modal-container",children:[n("div",{className:"create-board-input",children:o!==null&&n(G,{articleClassName:"selected-item",titleClassName:"searched-title",webtoon:o,webtoonItemImg:y("div",{className:"selected-img",children:[n("img",{alt:o.title,src:o.img,width:100,height:100}),n("span",{className:"deleted-img",onClick:_,children:n(ge,{})})]})})}),n("div",{className:"create-board-input",children:n(w.Wrapper,{label:"웹툰 검색",required:!0,children:n(w,{disabled:o!==null,placeholder:"작품 또는 작가로 검색한 후 선택하세요.",value:d,onChange:u=>h(u.target.value)})})}),!O&&n("ul",{className:"search-result",children:v?y(F,{children:[c==null?void 0:c.pages.map((u,T)=>n(B.Fragment,{children:Array.isArray(u)&&(u==null?void 0:u.map(z=>n("li",{className:"searched-item-wrap",onClick:()=>R(z),children:n(G,{articleClassName:"searched-item",titleClassName:"searched-title",webtoonItemImg:n("img",{alt:z.title,src:z.img,width:80,height:80}),webtoon:z})},z._id)))},T)),!!p&&n("div",{ref:e})]}):n(V,{className:"no-search-result",content:"검색 결과가 없습니다. 😥"})}),n("div",{className:"create-board-input",children:n(w.Wrapper,{label:"제목",required:!0,children:n(w,{placeholder:"후기 제목을 입력해주세요.",value:b,onChange:u=>{C(u.target.value)}})})}),n("div",{className:"create-board-input",children:n(w.Wrapper,{label:"내용",required:!0,children:n(X,{minRows:8,maxRows:12,placeholder:"후기 내용을 입력해주세요.",value:N,onChange:u=>{E(u.target.value)}})})}),n("div",{className:"create-board-btn",children:n("button",{onClick:I,children:"후기 작성"})})]})},Ke=()=>{const[a,r]=Se($),e=()=>{if(U(Y)===null){L(K,"yellow");return}else r(!a)};return y("div",{className:"create-board-container",children:[n("div",{className:"create-board-btn",onClick:e,children:n(ye,{})}),n(Ye,{isOpen:a,toggle:e})]})},Je=({pathname:a})=>xe([a],()=>we(a)),tt=()=>{const{pathname:a}=Ne(),r=Ce(),e=Re($),{data:t,refetch:i,isLoading:d,isError:h}=Je({pathname:a});s.useEffect(()=>{i()},[e]);const v=l=>{U(Y)===null?L(K,"yellow"):r(`/board/detail/${l}`)};return d?n(_e,{}):h?n(F,{}):y("div",{className:"board-container",children:[t&&(t==null?void 0:t.length)===0?n(V,{className:"empty-board",content:y(F,{children:[n("h2",{children:a==="/board"?"후기가 아직 없어요. 😥":"해당하는 플랫폼의 후기가 아직 없어요. 😥"}),n("h4",{children:"기억에 남는 웹툰의 후기를 작성해보세요."})]})}):n("ul",{className:"board-list",children:t==null?void 0:t.map(({_id:l,title:p,author:c,description:g,webtoon:m})=>y("li",{className:"board",onClick:()=>v(l),children:[n("div",{className:"board-img-container",children:n("img",{alt:m.title,src:m.img,className:"board-img"})}),y("div",{className:"board-description",children:[n("h4",{children:p}),y("h5",{children:[m.title," | ",m.author]}),y("div",{className:"creater",children:[n("span",{className:"board-author-img",children:n("img",{alt:"사용자 프로필 사진",src:c.profileImage,width:28,height:28})}),"by",n("span",{className:"nickname",children:c.nickname})]}),n("p",{children:g})]})]},l))}),n(Ke,{})]})};export{tt as default};
